/*
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
*                                                                             *
*                   RAM, ROM & I/O DECODING PLD SOURCE                 *
*                                                                             *
* --------------------------------------------------------------------------- *
*     Copyright (C)2024 by Open Software Ltda.   All rights reserved.     *
*                                                                             *
* Permission is hereby granted to copy and redistribute this software,  prov- *
* ided this copyright notice remains in the source code & proper  attribution *
* is given.   Any redistribution, regardless of form, must be at no charge to *
* the end user.   This code MAY NOT be incorporated into any package intended *
* for sale unless written permission has been given by the copyright holder.  *
*                                                                             *
* THERE IS NO WARRANTY OF ANY KIND WITH THIS SOFTWARE.   The user assumes all *
* risk in connection with the incorporation of this software into any system. *
*                                                                             *
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *

* * * * * * * * * *
* VERSION HISTORY *
* * * * * * * * * *

Ver  Rev Date    Revision
-------------------------------------------------------------------------------
 01  2024/01/29  Initial version.
-------------------------------------------------------------------------------

MEMORY MAP -- 

   +------------------------------------------------------------------------------------------------------+-------+
   | Memory definition            A15 A14 A13 A12 | A11 A10 A09 A08 | A07 A06 A05 A04  |  A03 A02 A01 A00 | Addr. |
   +------------------------------------------------------------------------------------------------------+-------+
   | $0000 - $7FFF   RAM (32K)      0   0   0   0     0   0   0   0		0   0   0   0	 	0   0   0   0 |	$8000 |
   |								0   1   1   1     1   1   1   1		1   1   1   1		1   1   1   1 |	$8FFF |
   +------------------------------------------------------------------------------------------------------+-------+
   | $8000 - $8FFF   I/O (4k):      1   0   0   0     0   0   0   0		0   0   0   0	 	0   0   0   0 |	$8000 |
   |        						1   0   0   0     1   1   1   1		1   1   1   1		1   1   1   1 |	$8FFF |
   +------------------------------------------------------------------------------------------------------+-------+							  
   | $0000 - $07FF - Generic I/O    1   0   0   0	  0   0   0   0		0   0   0   0	 	0   0   0   0 |	$8000 |
   |								1   0   0   0     0   1   1   1		1   1   1   1		1   1   1   1 |	$87FF |
   +------------------------------------------------------------------------------------------------------+-------+							  
   | $0800 - $0FFF - Stot selection	1   0   0   0     1   0   0   0		0   0   0   0	 	0   0   0   0 |	$8800 |
   |								1   0   0   0     1   1   1   1		1   1   1   1		1   1   1   1 |	$8FFF |
   +------------------------------------------------------------------------------------------------------+-------+							  
   | $0800 Slot A					1   0   0   0     1   0   0   0		0   0   0   0	 	0   0   0   0 |	$8800 |
   |								1   0   0   0     1   0   0   0		1   1   1   1	 	1   1   1   1 |	$88FF |
   +------------------------------------------------------------------------------------------------------+-------+
   | $0801 Slot B					1   0   0   0     1   0   0   1		0   0   0   0	 	0   0   0   0 |	$8900 |
   |								1   0   0   0     1   0   0   1		1   1   1   1	 	1   1   1   1 |	$89FF |
   +------------------------------------------------------------------------------------------------------+-------+
   | $0802 Slot C					1   0   0   0     1   0   1   0		0   0   0   0	 	0   0   0   0 |	$8A00 |
   |								1   0   0   0     1   0   1   0		1   1   1   1	 	1   1   1   1 |	$8AFF |
   +------------------------------------------------------------------------------------------------------+-------+
   | $0803 Slot D					1   0   0   0     1   0   1   1		0   0   0   0	 	0   0   0   0 |	$8B00 |
   |		                        1   0   0   0     1   0   1   1		1   1   1   1	 	1   1   1   1 |	$8BFF |
   +------------------------------------------------------------------------------------------------------+-------+
   | $0804 Slot E					1   0   0   0     1   1   0   0		0   0   0   0	 	0   0   0   0 |	$8C00 |
   |		                        1   0   0   0     1   1   0   0		1   1   1   1	 	1   1   1   1 |	$8CFF |
   +------------------------------------------------------------------------------------------------------+-------+
   | $0805 Slot F					1   0   0   0     1   1   0   1		0   0   0   0	 	0   0   0   0 |	$8D00 |
   |		                        1   0   0   0     1   1   0   1		1   1   1   1	 	1   1   1   1 |	$8DFF |
   +------------------------------------------------------------------------------------------------------+-------+
   | $0806 Slot G					1   0   0   0     1   1   1   0		0   0   0   0	 	0   0   0   0 |	$8E00 |
   |		                        1   0   0   0     1   1   1   0		1   1   1   1	 	1   1   1   1 |	$8EFF |
   +------------------------------------------------------------------------------------------------------+-------+
   | $0807 Slot H					1   0   0   0     1   1   1   1		0   0   0   0	 	0   0   0   0 |	$8F00 |
   |                                1   0   0   0     1   1   1   1		1   1   1   1	 	1   1   1   1 |	$8FFF |
   +------------------------------------------------------------------------------------------------------+-------+
   | $9000 - $FFFF   ROM (28K)                                                                            |       |
   +------------------------------------------------------------------------------------------------------+-------+


REQUIRED INPUTS:

    Sig   Meaning
    ----------------------------------------
	A15   CPU address bus
	A14   CPU address bus
	A13   CPU address bus
	A12   CPU address bus
	A11   CPU address bus
	A10   CPU address bus
	A09   CPU address bus
	A08   CPU address bus
    ----------------------------------------


GENERATED OUTPUTS (active low):

    Sig   Meaning
    ------------------
    ROM   ROM enable
    RD    READ enable
    IO    R/W INPUT/OUTPUT
	PORT  Ports enable signal
    SLOT1 Slot enable signal
    SLOT2 Slot enable signal
    SLOT3 Slot enable signal
    SLOT4 Slot enable signal
    SLOT5 Slot enable signal
    ------------------
*/


/*
* * * * * * * * *
* START OF CODE *
* * * * * * * * *
*/

Name      SPARTAN;
PartNo    2024012901;
Date      2024/01/29;
Revision  02;
Designer  PDSilva        ;
Company   Open Software Ltda;
Assembly  None;
Location  None;
Device    g20v8a;
/*
* * * * * * * * * * * *
* INPUT  DECLARATIONS *
* * * * * * * * * * * *

           GAL22V10                           GAL22V10
          ---------                          ---------
       I |1      24| Vcc                A15 |1      24| Vcc
       I |2      23| I                  A14 |2      23| NC
       I |3      22| O                  A13 |3      22| ROM
       I |4      21| O                  A12 |4      21| RD
       I |5      20| O                  A11 |5      20| IO
       I |6      19| O                  A10 |6      19| PORT
       I |7      18| O                  A09 |7      18| SLOT1
       I |8      17| O                  A08 |8      17| SLOT2
       I |9      16| O                   RW |9      16| SLOT3
       I |10     15| O                   NC |10     15| SLOT4
       I |11     14| I                   NC |11     14| NC   
    Gnd  |12     13| I/OE              Gnd  |12     13| NC
          ---------                          ---------

    Pins designated N/C should be grounded to avoid noise problems.
*/

pin 1  = A15;
pin 2  = A14;
pin 3  = A13;
pin 4  = A12;
pin 5  = A11;
pin 6  = A10;
pin 7  = A09;
pin 8  = A08;
PIN 9  = RW;

/*
* * * * * * * * * * * *
* OUTPUT DECLARATIONS *
* * * * * * * * * * * *

          ---------
         |1      24|
         |2      23| NC 
         |3      22| ROM
         |4      21| RD
         |5      20| IO
         |6      19| PORT
         |7      18| SLOT1
         |8      17| SLOT2
     NC  |9      16| SLOT3
     NC  |10     15| SLOT4
     NC  |11     14| NC
         |12     13| NC
          ---------

    All outputs are low true.  RD is the inversion of the MPU's RWB output & should
    be used to activate the "output enable" input on commonly used RAM, ROM & I/O
    devices.

    Pins designated N/C should be grounded to avoid noise problems.
*/

pin 22 = !ROM;
pin 21 = !RD;
pin 20 = !IO;
pin 19 = !PORT;
pin 18 = !SLOT1;
pin 17 = !SLOT2;
pin 16 = !SLOT3;
pin 15 = !SLOT4;





/*
* * * * * * * * * * * * * *
* MEMORY  SELECTION LOGIC *
* * * * * * * * * * * * * *
*/

RD   =  RW;
ROM  =  A15 & IO;


/*
* * * * * * * * * * * * * * * *
* I/O DEVICE  SELECTION LOGIC *
* * * * * * * * * * * * * * * *
*/

IO = A15 & ( A14 # A13 # A12);
SLOT1 = ( A11 & (!A10) & (!A09) & (!A08) ); /*1 0 0 0 0x0800*/
SLOT2 = ( A11 & (!A10) & (!A09) &   A08  ); /*1 0 0 1 0x0900*/
SLOT3 = ( A11 & (!A10) &   A09  & (!A08) ); /*1 0 1 0 0x0A00*/
SLOT4 = ( A11 & (!A10) &   A09  &   A08  ); /*1 0 1 1 0x0B00*/

